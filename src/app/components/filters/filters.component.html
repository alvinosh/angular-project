<div class="mb-6 flex flex-wrap gap-3 items-center">
  <div
    class="flex items-center gap-2 p-1.5 bg-gray-100/50 dark:bg-gray-800/50 rounded-full border border-gray-200/50 dark:border-gray-700/50"
  >
    <label for="sort-select" class="sr-only" i18n>Sort trips by</label>
    <select
      id="sort-select"
      [value]="sort().by"
      (change)="onSortChange($event)"
      class="bg-transparent pl-4 pr-2 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-200 focus:outline-none cursor-pointer"
      i18n-aria-label
      aria-label="Sort by"
    >
      <option value="title" i18n>Name</option>
      <option value="price" i18n>Price</option>
      <option value="rating" i18n>Rating</option>
      <option value="creationDate" i18n>Creation Date</option>
    </select>

    <button
      (click)="onSortOrderToggle()"
      class="flex items-center justify-center w-8 h-8 rounded-full bg-white dark:bg-gray-700 shadow-sm text-gray-600 dark:text-gray-200 hover:text-primary-600 dark:hover:text-primary-400 transition-all active:scale-95"
      [attr.aria-label]="getSortAriaLabel()"
    >
      <span class="text-xs font-bold">{{ sort().order === 'ASC' ? '↑' : '↓' }}</span>
    </button>
  </div>

  <button
    (click)="onShowFiltersToggle()"
    class="group relative flex items-center gap-2 px-6 py-2.5 rounded-full bg-linear-to-tr from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white text-sm font-semibold shadow-md shadow-green-500/20 transition-all active:scale-95"
    [attr.aria-label]="getShowFiltersAriaLabel()"
  >
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"
      ></path>
    </svg>
    {{ getShowFiltersText() }}
  </button>
</div>

@if (showFilters()) {
  <div
    class="mb-8 p-6 bg-white dark:bg-gray-900 border border-gray-200/60 dark:border-gray-700/60 rounded-3xl shadow-xl shadow-gray-200/20 dark:shadow-none animate-in fade-in slide-in-from-top-4 duration-300"
  >
    <div class="flex justify-between items-center mb-6">
      <h3 class="text-lg font-bold tracking-tight text-gray-900 dark:text-white" i18n>Filters</h3>
      <span
        class="text-[10px] uppercase tracking-widest font-bold text-gray-400 dark:text-gray-500 bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full"
        i18n
      >
        Esc to clear
      </span>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <div class="space-y-1.5">
        <label
          for="title-filter"
          class="ml-4 text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
          i18n
          >Title</label
        >
        <input
          id="title-filter"
          type="text"
          [value]="filters().title"
          (input)="onTitleFilterChange($event)"
          (blur)="onTitleFilterChange($event)"
          (keydown)="onFilterKeydown($event, 'title')"
          placeholder="Search by title..."
          class="w-full px-5 py-2.5 bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-full text-sm focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all dark:text-white"
        />
      </div>

      <div class="space-y-1.5">
        <label
          for="min-price"
          class="ml-4 text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
          i18n
          >Min Price</label
        >
        <input
          id="min-price"
          type="number"
          [value]="filters().minPrice"
          (input)="onMinPriceChange($event)"
          (blur)="onMinPriceChange($event)"
          (keydown)="onFilterKeydown($event, 'minPrice')"
          placeholder="0"
          class="w-full px-5 py-2.5 bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-full text-sm focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all dark:text-white"
        />
      </div>

      <div class="space-y-1.5">
        <label
          for="max-price"
          class="ml-4 text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
          i18n
          >Max Price</label
        >
        <input
          id="max-price"
          type="number"
          [value]="filters().maxPrice"
          (input)="onMaxPriceChange($event)"
          (blur)="onMaxPriceChange($event)"
          (keydown)="onFilterKeydown($event, 'maxPrice')"
          placeholder="10000"
          class="w-full px-5 py-2.5 bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-full text-sm focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all dark:text-white"
        />
      </div>

      <div class="space-y-1.5">
        <label
          for="min-rating"
          class="ml-4 text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
          i18n
          >Min Rating</label
        >
        <input
          id="min-rating"
          type="number"
          [value]="filters().minRating"
          (input)="onMinRatingChange($event)"
          (blur)="onMinRatingChange($event)"
          (keydown)="onFilterKeydown($event, 'minRating')"
          placeholder="0"
          min="0"
          max="5"
          step="0.1"
          class="w-full px-5 py-2.5 bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-full text-sm focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all dark:text-white"
        />
      </div>

      <div class="space-y-1.5">
        <label
          for="max-rating"
          class="ml-4 text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
          i18n
          >Max Rating</label
        >
        <input
          id="max-rating"
          type="number"
          [value]="filters().maxRating"
          (input)="onMaxRatingChange($event)"
          (blur)="onMaxRatingChange($event)"
          (keydown)="onFilterKeydown($event, 'maxRating')"
          placeholder="5"
          min="0"
          max="5"
          step="0.1"
          class="w-full px-5 py-2.5 bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-full text-sm focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all dark:text-white"
        />
      </div>

      <div class="space-y-1.5">
        <label
          for="tags-filter"
          class="ml-4 text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
          i18n
          >Tags</label
        >
        <div
          class="min-h-10.5 px-4 py-1.5 border border-gray-200 dark:border-gray-700 rounded-[22px] bg-gray-50 dark:bg-gray-800/50 focus-within:ring-2 focus-within:ring-primary-500/20 focus-within:border-primary-500 transition-all flex flex-wrap gap-2 items-center"
        >
          @for (tag of filters().tags; track tag) {
            <span
              class="inline-flex items-center pl-3 pr-1 py-1 rounded-full text-xs font-semibold bg-primary-500/10 text-primary-700 dark:text-primary-300 border border-primary-500/20 filter-tag"
            >
              {{ tag }}
              <button
                (click)="onRemoveTag(tag)"
                [attr.aria-label]="getRemoveTagAriaLabel(tag)"
                class="ml-1 p-0.5 rounded-full hover:bg-primary-500/20 transition-colors"
              >
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                  <path
                    d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                  />
                </svg>
              </button>
            </span>
          }
          <input
            id="tags-filter"
            type="text"
            (keydown)="onTagKeydown($event)"
            (input)="onTagInput($event)"
            placeholder="Add tag... *API Not Working :("
            class="flex-1 min-w-20 bg-transparent outline-none text-sm dark:text-white"
          />
        </div>
      </div>
    </div>

    <div class="mt-8 flex justify-end">
      <button
        (click)="onClearFilters()"
        class="px-8 py-2 rounded-full text-sm font-bold text-gray-500 dark:text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition-colors"
        aria-label="Clear all filters"
        i18n
      >
        Clear all filters
      </button>
    </div>
  </div>
}
